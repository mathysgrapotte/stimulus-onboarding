# PCA Reconstructor Model Configuration for Stimulus Hyperparameter Tuning
# Network parameters will be partially inferred at runtime (pca_dim, gene_dim)

dataset:
    type: H5adDataset
    params: {}

network_params:
  # Model type selection
  model_type:
    mode: categorical
    params:
      choices:
        #- "linear"
        - "mlp"
        # - "hybrid"  # Uncomment to include hybrid model in search

  # Hidden dimensions for MLP and Hybrid models (variable length list)
  hidden_dims:
    mode: variable_list
    length:
      mode: int
      params:
        low: 1
        high: 3
    values:
      mode: categorical
      params:
        choices: [256, 512, 1024, 2048, 4096]

  # Dropout rate
  dropout_rate:
    mode: float
    params:
      low: 0.0
      high: 0.3

  # Residual weight for hybrid model
  residual_weight:
    mode: float
    params:
      low: 0.01
      high: 0.5
      log: true

optimizer_params:
  method:
    mode: categorical
    params:
      choices:
        - "AdamW"

  lr:
    mode: float
    params:
      low: 1.0e-5
      high: 1.0e-3
      log: true

  weight_decay:
    mode: float
    params:
      low: 1.0e-6
      high: 1.0e-2
      log: true

data_params:
  batch_size:
    mode: categorical
    params:
      choices: [512]

loss_params: {}

pruner:
  name: "MedianPruner"
  params:
    n_startup_trials: 5
    n_warmup_steps: 3
    interval_steps: 1

sampler:
  name: "TPESampler"
  params:
    seed: 42
    n_startup_trials: 10

objective:
  metric: "val_loss"
  direction: "minimize"

device: null
seed: 42
max_samples: 60000
compute_objective_every_n_samples: 20000
n_trials: 5
